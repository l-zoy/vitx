{"version":3,"sources":["config.ts"],"names":["CONFIG_FILES","cwd","isTest","process","env","NODE_ENV","configFile","map","configName","path","join","userConfig","find","configCwd","fs","existsSync","config","require","schema","validate","error","Error","message"],"mappings":";;;;;;;;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAEA;;AAGA;;;;AAEO,MAAMA,YAAY,GAAG,CAAC,YAAD,EAAe,YAAf,CAArB;;;AAEO,kBAAWC,GAAX,EAAsB;AAAA;;AAClC,QAAMC,MAAM,GAAGC,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,MAAxC;AACA,QAAMC,UAAU,GAAGN,YAAY,CAACO,GAAb,CAAkBC,UAAD,IAClCC,gBAAKC,IAAL,CAAUT,GAAV,EAAeO,UAAf,CADiB,CAAnB;AAIA,QAAMG,UAAU,uBACdL,UAAU,CAACM,IAAX,CAAiBC,SAAD,IAAeC,cAAGC,UAAH,CAAcF,SAAd,CAA/B,CADc,+DAC8C,EAD9D;AAGA,MAAIG,MAAM,GAAG,EAAb;;AAEA,MAAIL,UAAJ,EAAgB;AACd;AACAT,IAAAA,MAAM,IAAI,0BAAcS,UAAd,CAAV;AACAK,IAAAA,MAAM,GAAG,sBAAUC,OAAO,CAACN,UAAD,CAAjB,CAAT;;AAHc,6BAKIO,gBAAOC,QAAP,CAAgBH,MAAhB,CALJ;AAAA,UAKNI,KALM,oBAKNA,KALM;;AAOd,QAAIA,KAAJ,EAAW;AACT,YAAM,IAAIC,KAAJ,CAAU,sBAAsBD,KAAK,CAACE,OAAO,EAA7C,CAAN;AACD;AACF;;AACD,SAAON,MAAP;AACD","file":"config.js","sourcesContent":["import path from 'path'\nimport fs from 'fs'\n\nimport { registerBabel, isDefault } from './utils'\nimport { IBundleOptions } from './types'\n\nimport schema from './schema'\n\nexport const CONFIG_FILES = ['.nerdrc.ts', '.nerdrc.js']\n\nexport default function (cwd: string): IBundleOptions {\n  const isTest = process.env.NODE_ENV !== 'test'\n  const configFile = CONFIG_FILES.map((configName) =>\n    path.join(cwd, configName)\n  )\n\n  const userConfig =\n    configFile.find((configCwd) => fs.existsSync(configCwd)) ?? ''\n\n  let config = {}\n\n  if (userConfig) {\n    // https://github.com/facebook/jest/issues/7864\n    isTest && registerBabel(userConfig)\n    config = isDefault(require(userConfig))\n\n    const { error } = schema.validate(config)\n\n    if (error) {\n      throw new Error(`Invalid options in ${error.message}`)\n    }\n  }\n  return config\n}\n"],"sourceRoot":"/Users/zoy/zmi-nerd/src"}